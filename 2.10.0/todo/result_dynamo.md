
# Release Notes worksheet dynamo

The main goal of this process is to rephrase all the commit messages below to make them **clear and easy to read** by the end user. You should follow the following instructions to do so:

* **Please clean up and format commit titles to be readable by the general PyTorch user.** Make sure you're [following the guidance here](https://docs.google.com/document/d/14OmgGBr1w6gl1VO47GGGdwrIaUNr92DFhQbY_NEk8mQ/edit)! Your resulting notes must be consistent and easy to read.
* Please sort commits into the following categories (you should not rename the categories!), I tried to pre-sort these to ease your work, feel free to move commits around if the current categorization is not good.
* Anything that is not public facing needs to be removed.
* If anything is miscategorized/belongs to another domain, move it to `miscategorized.md`.
* Please scan through `miscategorized.md` and handle any commits that belong within your domain according to these instructions.
* We place a lot of emphasis on the “BC-breaking” and “deprecation” sections. Those should be where the most effort goes in. The “improvements” and “bug fixes” for Python API should be nice as well.
* Once you are finished, move this very file from `todo/` to `done/` and submit a pull request.

The categories below are as follows:

* BC breaking: All commits that are BC-breaking. These are the most important commits. If any pre-sorted commit is actually BC-breaking, do move it to this section. Each commit should contain a paragraph explaining the rational behind the change as well as an example for how to update user code [BC-Guidelines](https://docs.google.com/document/d/14OmgGBr1w6gl1VO47GGGdwrIaUNr92DFhQbY_NEk8mQ/edit#heading=h.a9htwgvvec1m).
* Deprecations: All commits introducing deprecation. Each commit should include a small example explaining what should be done to update user code.
* new_features: All commits introducing a new feature (new functions, new submodule, new supported platform etc)
* improvements: All commits providing improvements to existing feature should be here (new backend for a function, new argument, better numerical stability)
* bug fixes: All commits that fix bugs and behaviors that do not match the documentation
* performance: All commits that are added mainly for performance (we separate this from improvements above to make it easier for users to look for it)
* documentation: All commits that add/update documentation
* Developers: All commits that are not end-user facing but still impact people that compile from source, develop into pytorch, extend pytorch, etc
* not user facing: All commits that are not public end-user facing and hence should be dropped from the release notes

## dynamo
### bc breaking
### deprecation
### new features
### improvements
### bug fixes
- [dynamo] fix error_on_graph_break bug where non-empty checkpoint results in unwanted graph break resumption ([#166586](https://github.com/pytorch/pytorch/pull/166586))
### performance
### docs
### devs
### Untopiced
- Fix persistent buffer bug ([#162190](https://github.com/pytorch/pytorch/pull/162190))
- Support vmap + custom autograd function/improve DTensor constructor inefficiency ([#162240](https://github.com/pytorch/pytorch/pull/162240))
- [dynamo] Add DUAL_LEVEL_MATCH C++ guard ([#162528](https://github.com/pytorch/pytorch/pull/162528))
- [doc]: Small typos ([#162982](https://github.com/pytorch/pytorch/pull/162982))
- Fix error message ([#162487](https://github.com/pytorch/pytorch/pull/162487))
- Prefer_deferred_runtime_asserts should be propagated to new tracer ([#162556](https://github.com/pytorch/pytorch/pull/162556))
- fixing graph break for namedtuple._replace ([#160139](https://github.com/pytorch/pytorch/pull/160139))
- [dynamic shapes] DynamicInts prototype ([#162194](https://github.com/pytorch/pytorch/pull/162194))
- SDP Backend function fix ([#161169](https://github.com/pytorch/pytorch/pull/161169))
- [dynamo] Fix issue with namedtuple slicing ([#163351](https://github.com/pytorch/pytorch/pull/163351))
- Preserve user annotation in graph ([#163673](https://github.com/pytorch/pytorch/pull/163673))
- Fix bug with renaming submodules in dynamo for new tracer ([#163136](https://github.com/pytorch/pytorch/pull/163136))
- Move inductor.aot_compile to use new tracer ([#163137](https://github.com/pytorch/pytorch/pull/163137))
- Use new_tracer_experimental for torchao strict export ([#163258](https://github.com/pytorch/pytorch/pull/163258))
- Remove unnecessary list comprehensions ([#164103](https://github.com/pytorch/pytorch/pull/164103))
- [2/N] Simplify "in" operation for containers of a single item ([#164323](https://github.com/pytorch/pytorch/pull/164323))
- Support calling torch.compile inside non-strict export ([#164171](https://github.com/pytorch/pytorch/pull/164171))
- [2/N] Fix ruff warnings ([#164460](https://github.com/pytorch/pytorch/pull/164460))
- Pyrefly suppressions 7/n ([#164913](https://github.com/pytorch/pytorch/pull/164913))
- [dynamo] Better error message for local_map subgraph mismatches number of inputs/outputs with placement info ([#164321](https://github.com/pytorch/pytorch/pull/164321))
- [1/N] Use "is" in python type comparison ([#165037](https://github.com/pytorch/pytorch/pull/165037))
- [2/N] Use "is" in python type comparison ([#165142](https://github.com/pytorch/pytorch/pull/165142))
- Reapply "[export] Turn on install_free_tensors flag (#164691)" (1803d40c995)
- [user-cuda-streams] Pass streams/events to the graph via lookup table ([#162899](https://github.com/pytorch/pytorch/pull/162899))
- [user-streams] Handle aliasing properly ([#163028](https://github.com/pytorch/pytorch/pull/163028))
- [user-cuda-streams] Add fork/join custom ops ([#162900](https://github.com/pytorch/pytorch/pull/162900))
- [dynamo, guards] Better error messages when generated guard fails on the same frame ([#165242](https://github.com/pytorch/pytorch/pull/165242))
- [dynamo] Support fx.traceback.annotate as decorator ([#165805](https://github.com/pytorch/pytorch/pull/165805))
- Fix dynamo stack trace ([#165930](https://github.com/pytorch/pytorch/pull/165930))
- [pytree][dynamo] trace on native optree functions for community pytree support ([#165860](https://github.com/pytorch/pytorch/pull/165860))
- [dynamo][annotate] Graph break cleanly on fx.traceback.annotate reconstruction ([#166006](https://github.com/pytorch/pytorch/pull/166006))
- [10/N] Apply ruff UP035 rule ([#165709](https://github.com/pytorch/pytorch/pull/165709))
- Clean up unused Pyrefly suppressions ([#166178](https://github.com/pytorch/pytorch/pull/166178))
- Fix pyrefly ignores 1/n ([#166239](https://github.com/pytorch/pytorch/pull/166239))
- Fix error suppression syntax in onnx, jit, _dynamo ([#166249](https://github.com/pytorch/pytorch/pull/166249))
- [user-streams] update stream context to use fork/join ([#162903](https://github.com/pytorch/pytorch/pull/162903))
- [user-streams] Move StreamContextVariable into streams module ([#164343](https://github.com/pytorch/pytorch/pull/164343))
- [user-streams] Have StreamVariable inherit from StreamContextVariable ([#164344](https://github.com/pytorch/pytorch/pull/164344))
- [user-streams] Support streams as contexts ([#164507](https://github.com/pytorch/pytorch/pull/164507))
- [3/N] fix typo in other folders ([#166606](https://github.com/pytorch/pytorch/pull/166606))
- Fix pyrefly errors on main ([#166548](https://github.com/pytorch/pytorch/pull/166548))
- Fix missing symbol when printing guards ([#165723](https://github.com/pytorch/pytorch/pull/165723))
- Use 'is' in callable comparisons ([#166624](https://github.com/pytorch/pytorch/pull/166624))
- [2/N] Use 'is' in callable comparisons ([#166685](https://github.com/pytorch/pytorch/pull/166685))
- [dynamo] Remove retrieving objects by ID ([#162905](https://github.com/pytorch/pytorch/pull/162905))
- [user-streams] Switch to fx annotations at trace time ([#166472](https://github.com/pytorch/pytorch/pull/166472))
- [dynamo] fix pos-only names should can be collected in `**kwargs` ([#166798](https://github.com/pytorch/pytorch/pull/166798))
- Add some Triton related suppressions that don't show on CI ([#166868](https://github.com/pytorch/pytorch/pull/166868))
- Add `_heapq` polyfill ([#161093](https://github.com/pytorch/pytorch/pull/161093))
- [dynamo] extend `collections.defaultdict` support with `*args`, `**kwargs` and custom `default_factory` ([#166793](https://github.com/pytorch/pytorch/pull/166793))
- [pytree][dynamo] add test to ensure `tree_map` preserves `dict` order ([#166236](https://github.com/pytorch/pytorch/pull/166236))
- [user-streams] Add graph annotation checks ([#167019](https://github.com/pytorch/pytorch/pull/167019))
- [1/N] Use `key in dict` for existence checks ([#167035](https://github.com/pytorch/pytorch/pull/167035))
- [user-streams] Enable stream ops to work in eager ([#167141](https://github.com/pytorch/pytorch/pull/167141))
- [user-streams] Add record/wait ops ([#167151](https://github.com/pytorch/pytorch/pull/167151))
- [user-streams] Mark stream ops as side effectful ([#167152](https://github.com/pytorch/pytorch/pull/167152))
- Prevent torch._check causing graph breaks ([#164676](https://github.com/pytorch/pytorch/pull/164676))
- [user-streams] Refactor user object index in streams ([#167175](https://github.com/pytorch/pytorch/pull/167175))
- [user-streams] Fix bug in object bytecode construction ([#167176](https://github.com/pytorch/pytorch/pull/167176))
- [user-streams] Trace events with the new ops ([#167177](https://github.com/pytorch/pytorch/pull/167177))
- [dynamo][pytree] support more `optree` functions by polyfill the underlying CXX functions directly ([#167292](https://github.com/pytorch/pytorch/pull/167292))
- [PT2 Compiler] Add annotation for dynamo disabled callables ([#166341](https://github.com/pytorch/pytorch/pull/166341))
- Use context managers (SIM115) ([#166928](https://github.com/pytorch/pytorch/pull/166928))
- [Dynamo] Support for xor ([#166065](https://github.com/pytorch/pytorch/pull/166065))
- [user-streams] Allow new events to be created and registered during compilation ([#167510](https://github.com/pytorch/pytorch/pull/167510))
- [user-streams] Allow new streams to be created and registered during compilation ([#167511](https://github.com/pytorch/pytorch/pull/167511))
- [user-streams] wait_stream op ([#167512](https://github.com/pytorch/pytorch/pull/167512))
- Support Python 3.14 Lazy Function Annotations on FX graph ([#167573](https://github.com/pytorch/pytorch/pull/167573))
- [export] stop gap strict export v2 enable and testing. ([#167236](https://github.com/pytorch/pytorch/pull/167236))
- Add option to disable applying side effects in dynamo ([#167239](https://github.com/pytorch/pytorch/pull/167239))
- [dynamo][DebugMode] mask python keys in dispatch_key_set guard checks ([#164992](https://github.com/pytorch/pytorch/pull/164992))
- [user-streams] Add API for accessing current stream given a device ([#167620](https://github.com/pytorch/pytorch/pull/167620))
- Fix no source name in backward kernel names; Add flex_attention HOP to "original_aten" node meta ([#167749](https://github.com/pytorch/pytorch/pull/167749))
- [dynamo] Make global state guards and torch function stack guards droppable. ([#167674](https://github.com/pytorch/pytorch/pull/167674))
- [user-streams] Assign streams to gradient accum in bwd ([#167513](https://github.com/pytorch/pytorch/pull/167513))
- [user-streams] Move user object bytecode generation after calling user compiler ([#167704](https://github.com/pytorch/pytorch/pull/167704))
- [user-streams] Stash graph created objects in keep_alive list for backwards ([#167705](https://github.com/pytorch/pytorch/pull/167705))
- [user-streams] Insert backward syncs ([#167747](https://github.com/pytorch/pytorch/pull/167747))
- [export] Enable context manager returns for dynamo graph capture. ([#168102](https://github.com/pytorch/pytorch/pull/168102))
- [triton] Enable Triton kernel serialization for AOTI by adding dict and int list argument types ([#167866](https://github.com/pytorch/pytorch/pull/167866))
- Remove useless parent method delegation ([#168355](https://github.com/pytorch/pytorch/pull/168355))
- [user-streams] Handle the record_stream problem ([#168061](https://github.com/pytorch/pytorch/pull/168061))
- ensure that regional inductor uses a boxed calling convention ([#168277](https://github.com/pytorch/pytorch/pull/168277))
- [Fix] Add safeguard for unsafe index ([#169234](https://github.com/pytorch/pytorch/pull/169234))
- [dynamo, guards] apply functools.cached_property to Source.name ([#168131](https://github.com/pytorch/pytorch/pull/168131))
- [annotate] Change AutogradFunctionApply HOP to use Interpreter to preserve annotation ([#169528](https://github.com/pytorch/pytorch/pull/169528))
- Use context managers ([#169447](https://github.com/pytorch/pytorch/pull/169447))
- [2/N] Fix incorrect homogeneous tuple types  ([#169766](https://github.com/pytorch/pytorch/pull/169766))
- [opaque_obj] Replace pytree.register_constant uses ([#169846](https://github.com/pytorch/pytorch/pull/169846))
- [dynamo] Handle step through usual dispatch in var tracker ([#169987](https://github.com/pytorch/pytorch/pull/169987))
- [dynamo] Make distributed vars hashable ([#169988](https://github.com/pytorch/pytorch/pull/169988))
- [dynamo] Allow distributed var equality ([#169989](https://github.com/pytorch/pytorch/pull/169989))
- [dynamo] Skip patch function for lr scheduler tracing ([#170019](https://github.com/pytorch/pytorch/pull/170019))
- updated error message and added test ([#169685](https://github.com/pytorch/pytorch/pull/169685))
### not user facing
- NamedTuple: Allow side effects for dynamic attributes ([#161645](https://github.com/pytorch/pytorch/pull/161645))
- [dynamo][refactor] Move get_framelocals_idx to a helper ([#162519](https://github.com/pytorch/pytorch/pull/162519))
- [dynamo][guards] Prevent framelocals to dict conversion for not required LAMBDA_GUARD ([#162509](https://github.com/pytorch/pytorch/pull/162509))
- [dynamo][guards] Do not consturct framelocals to dict on GlobalsGuardAccessor ([#162694](https://github.com/pytorch/pytorch/pull/162694))
- [precompile] Fix issues with guard serialization on distributed types. ([#162418](https://github.com/pytorch/pytorch/pull/162418))
- [pre_compile] Add check for cuda and hardware version ([#162438](https://github.com/pytorch/pytorch/pull/162438))
- Add DISABLE_JUSTKNOBS to torch/_utils_internal.py and use it for dynamo _maybe_set_eval_frame ([#162298](https://github.com/pytorch/pytorch/pull/162298))
- [precompile] Store traced file information with CompileArtifacts. ([#162983](https://github.com/pytorch/pytorch/pull/162983))
- Make inline tests to use new exporter and fix some issues around it ([#162682](https://github.com/pytorch/pytorch/pull/162682))
- [Intel GPU][pre_compile] Add XPU toolkit version and hardware info in compiled model check. ([#162951](https://github.com/pytorch/pytorch/pull/162951))
- Make dynamo preserving stack trace work with inlined nn modules ([#162992](https://github.com/pytorch/pytorch/pull/162992))
- Turn on capture_scalar_outputs when fullgraph=True ([#163121](https://github.com/pytorch/pytorch/pull/163121))
- Turn on capture_dynamic_output_shape_ops when fullgraph=True ([#163123](https://github.com/pytorch/pytorch/pull/163123))
- Refactor PrecompileContext to be considerably more debuggable ([#162740](https://github.com/pytorch/pytorch/pull/162740))
- Realize LazyVariableTracker before raising exception ([#163350](https://github.com/pytorch/pytorch/pull/163350))
- Simplify PrecompileContext to no longer be a CacheArtifactManager ([#162886](https://github.com/pytorch/pytorch/pull/162886))
- minimize graph capture output ([#162211](https://github.com/pytorch/pytorch/pull/162211))
- make fullgraph_capture work on mod, args, kwargs ([#162849](https://github.com/pytorch/pytorch/pull/162849))
- dynamo: Handle objects in graph that do not support weakref ([#163168](https://github.com/pytorch/pytorch/pull/163168))
- [dynamo] Fix TorchFunctionMode handling with get_rng_state ([#163412](https://github.com/pytorch/pytorch/pull/163412))
- docs and optional kwargs for full graph capture ([#163550](https://github.com/pytorch/pytorch/pull/163550))
- [Code Clean] Remove deadcodes about Python3.9 [7/N] ([#163646](https://github.com/pytorch/pytorch/pull/163646))
- [dynamo] Fix handling of kwargs in exception constructor ([#163390](https://github.com/pytorch/pytorch/pull/163390))
- [PGO] distinguish sticky PGO put ([#163799](https://github.com/pytorch/pytorch/pull/163799))
- [PGO] ignore extra PGO key if warm/cold cache present ([#163810](https://github.com/pytorch/pytorch/pull/163810))
- Remove dataclass_slots ([#163623](https://github.com/pytorch/pytorch/pull/163623))
- [dynamo][guards] Revert introduction of different types of lambda_guards ([#163385](https://github.com/pytorch/pytorch/pull/163385))
- graph break on tolist if capture_scalar_outputs is false ([#163807](https://github.com/pytorch/pytorch/pull/163807))
- Building guards should be under metrics_context ([#163967](https://github.com/pytorch/pytorch/pull/163967))
- [dynamo][logging] Add to param_count only if metrics_count is active ([#164079](https://github.com/pytorch/pytorch/pull/164079))
- [hops] Support unspecialized nn module for export hops ([#164082](https://github.com/pytorch/pytorch/pull/164082))
- [dynamo][export] Make the source_stack and fqn info same between dynamo and export ([#164085](https://github.com/pytorch/pytorch/pull/164085))
- [dynamo][export] Add some missing trace rules ([#164080](https://github.com/pytorch/pytorch/pull/164080))
- [dynamo][device_mesh] Support mesh_dim_names ([#164200](https://github.com/pytorch/pytorch/pull/164200))
- [dynamo] format cpython_defs.c ([#161838](https://github.com/pytorch/pytorch/pull/161838))
- [dynamo, 3.14] Python dynamo changes to get basic programs working ([#161839](https://github.com/pytorch/pytorch/pull/161839))
- [dynamo, 3.14] fix context managers ([#163109](https://github.com/pytorch/pytorch/pull/163109))
- [dynamo, 3.14] support LOAD_CONST on slice, codegen LOAD_CONST slice instead of BINARY/STORE_SLICE ([#163110](https://github.com/pytorch/pytorch/pull/163110))
- [dynamo, 3.14] fix inactive ctx handling in resume functions ([#163191](https://github.com/pytorch/pytorch/pull/163191))
- [dynamo, 3.14] fix WITH_EXCEPT_START ([#163292](https://github.com/pytorch/pytorch/pull/163292))
- [dynamo, 3.14] fix BUILD_TUPLE with 0 args ([#163818](https://github.com/pytorch/pytorch/pull/163818))
- [dynamo, 3.14] support LOAD_COMMON_CONSTANT ([#163919](https://github.com/pytorch/pytorch/pull/163919))
- [dynamo, 3.14] fix tracing typing.Union ([#164004](https://github.com/pytorch/pytorch/pull/164004))
- [dynamo][sac] Support functools partial context_fn for sac ([#164308](https://github.com/pytorch/pytorch/pull/164308))
- [dynamo] Use strings instead of modules for fqn info tracking ([#164272](https://github.com/pytorch/pytorch/pull/164272))
- [dynamo] do not pop from framelocals dict in Python 3.10 ([#164316](https://github.com/pytorch/pytorch/pull/164316))
- [export] Preserve nn_module_stack for aliased nn modules ([#164311](https://github.com/pytorch/pytorch/pull/164311))
- [dynamo][export] Do not graph break on torch.autograd._profiler_enabled for export ([#164418](https://github.com/pytorch/pytorch/pull/164418))
- Support partial _DynamoCacheEntries when not all backends available ([#163521](https://github.com/pytorch/pytorch/pull/163521))
- [precompile] Fix guard serialization loading bugs. ([#164490](https://github.com/pytorch/pytorch/pull/164490))
- [precompile][ez] Inline type definition for dynamo cache entry. ([#164580](https://github.com/pytorch/pytorch/pull/164580))
- [precompile][ez] Add instrumentation for guard loading/building. ([#164602](https://github.com/pytorch/pytorch/pull/164602))
- Fix typo in class definition of bytecodedispatchtable ([#164761](https://github.com/pytorch/pytorch/pull/164761))
- [dynamo] Inline nn module calls using __call__ methods ([#164817](https://github.com/pytorch/pytorch/pull/164817))
- [precompile] Load source cache for AOT compile as well. ([#164773](https://github.com/pytorch/pytorch/pull/164773))
- [BE][Ez]: Enable RUF007 Prefer itertools.pairwise over zip slicing ([#164856](https://github.com/pytorch/pytorch/pull/164856))
- Add split-K control to cuBLAS reduced-precision settings ([#164766](https://github.com/pytorch/pytorch/pull/164766))
- [dynamo, nested graph breaks] move cell codegen before side effects codegen ([#160601](https://github.com/pytorch/pytorch/pull/160601))
- [dynamo, nested graph breaks] fix nested step graph break related issues ([#162737](https://github.com/pytorch/pytorch/pull/162737))
- [dynamo] allow placement subclass to be traceble ([#164985](https://github.com/pytorch/pytorch/pull/164985))
- [export][dynamo] Fallback to slowpath for MultiHeadAttention for strict export ([#164721](https://github.com/pytorch/pytorch/pull/164721))
- [PGO] log missing sources in allowlist ([#164881](https://github.com/pytorch/pytorch/pull/164881))
- [dynamo][trace_rules] Add ao.quantization ([#165069](https://github.com/pytorch/pytorch/pull/165069))
- [dynamo] trace local_map with local shapes for AP ([#163602](https://github.com/pytorch/pytorch/pull/163602))
- [hop] support local_map None placements ([#164433](https://github.com/pytorch/pytorch/pull/164433))
- [dynamo][logging] Add most recent bytecode to graph break with torch._dynamo.graph_break() and verbose ([#164422](https://github.com/pytorch/pytorch/pull/164422))
- Add pytorch_version and mast_application_packages to pt2 compile scuba logging ([#165018](https://github.com/pytorch/pytorch/pull/165018))
- [Bugfix][Inductor][Dynamo] Fix stride incorrectness issues for stride 0 tensor ([#164897](https://github.com/pytorch/pytorch/pull/164897))
- [dynamo][executorch] Handle lowered module from executorch delegate specially ([#165172](https://github.com/pytorch/pytorch/pull/165172))
- do not overguard when comparing lists ([#165091](https://github.com/pytorch/pytorch/pull/165091))
- [dynamo] fix potential 3.12+ THP_PyOpcode_Caches init error seen internally ([#165200](https://github.com/pytorch/pytorch/pull/165200))
- Avoids calling builtin `iter` if object is a generator ([#162521](https://github.com/pytorch/pytorch/pull/162521))
- [Easy][Test][Dynamo] Avoid direct string comparison in MiscTestsDevice::get_device_module ([#165314](https://github.com/pytorch/pytorch/pull/165314))
- [dynamo][executorch] Return already added nn.Module during registration ([#165338](https://github.com/pytorch/pytorch/pull/165338))
- [user-streams] Move stream code to streams module ([#163027](https://github.com/pytorch/pytorch/pull/163027))
- [dict] Implement `__eq__` for dict_items ([#155154](https://github.com/pytorch/pytorch/pull/155154))
- [Dynamo] Fixes for exceptions ([#153966](https://github.com/pytorch/pytorch/pull/153966))
- dynamo configs to torch.compiler ([#163517](https://github.com/pytorch/pytorch/pull/163517))
- [precompile] Fix frame construction for wrapped model. ([#165454](https://github.com/pytorch/pytorch/pull/165454))
- Relax equality check ([#165460](https://github.com/pytorch/pytorch/pull/165460))
- tmp fix for compile internal logger issue ([#165568](https://github.com/pytorch/pytorch/pull/165568))
- Megacache integration ([#163533](https://github.com/pytorch/pytorch/pull/163533))
- [Dynamo][Logging] Add sources/types to LazyVariableTracker logging ([#165402](https://github.com/pytorch/pytorch/pull/165402))
- [Bugfix][Dynamo] Fix Sparse tensors by graph break  in Dynamo ([#164873](https://github.com/pytorch/pytorch/pull/164873))
- Start recording inductor provenance ([#162669](https://github.com/pytorch/pytorch/pull/162669))
- [dynamo] Use Variable Builder to build the property fget object ([#165683](https://github.com/pytorch/pytorch/pull/165683))
- torch.compile: populate compiler_config ([#165581](https://github.com/pytorch/pytorch/pull/165581))
- Don't run compile inside kernel invocation ([#165687](https://github.com/pytorch/pytorch/pull/165687))
- [precompile] Pass tensor_to_context to backend. ([#165702](https://github.com/pytorch/pytorch/pull/165702))
- [dynamo][easy] Support torch.accelerator.current_accelerator ([#165734](https://github.com/pytorch/pytorch/pull/165734))
- [dynamo][ac] Config flag to allow eager and compile AC divergence for side-effects ([#165775](https://github.com/pytorch/pytorch/pull/165775))
- Fix issues with generalized_scatter  and setitem allocated unbacked symbols. ([#164341](https://github.com/pytorch/pytorch/pull/164341))
- Improve dynamo graph capture stack trace for custom ops ([#165693](https://github.com/pytorch/pytorch/pull/165693))
- Introduce a generic API torch._C._accelerator_setAllocatorSettings ([#165291](https://github.com/pytorch/pytorch/pull/165291))
- [dynamo] Clean up assert in dynamo [1/N] ([#165430](https://github.com/pytorch/pytorch/pull/165430))
- [dynamo] Add recompile reason for set_stance fail_on_recompile ([#165445](https://github.com/pytorch/pytorch/pull/165445))
- [dynamo] Remove duplicated guards ([#165806](https://github.com/pytorch/pytorch/pull/165806))
- [dynamo][nn_module] Replace UserFunctionVariable with VariableTracker build ([#165708](https://github.com/pytorch/pytorch/pull/165708))
- better error message when there is no pytree impl ([#165955](https://github.com/pytorch/pytorch/pull/165955))
- Fix creation of `BINARY_SUBSCR` in Python 3.14+ ([#165864](https://github.com/pytorch/pytorch/pull/165864))
- [dynamo][remaining] Replace UserFunctionVariable with VariableTracker build ([#165896](https://github.com/pytorch/pytorch/pull/165896))
- [dynamo] Fix MATCH_KEYS for dict pattern matching ([#165956](https://github.com/pytorch/pytorch/pull/165956))
- [dynamo] Clean up assert in dynamo [2/N] ([#165745](https://github.com/pytorch/pytorch/pull/165745))
- [vmap][dynamo] use create_proxy instead of create_node in vmap increate nesting ctx manager ([#165675](https://github.com/pytorch/pytorch/pull/165675))
- inductor_provenance: Correctly handle null provenance ([#166019](https://github.com/pytorch/pytorch/pull/166019))
- Revert "[dynamo][easy] Support torch.accelerator.current_accelerator (#165734)" ([#166094](https://github.com/pytorch/pytorch/pull/166094))
- [dynamo] Remove ID guard on method object ([#166096](https://github.com/pytorch/pytorch/pull/166096))
- [Dynamo][Logging]Fix regression on stack adding to latest bytecode by… ([#165946](https://github.com/pytorch/pytorch/pull/165946))
- [dynamo] Avoid ID_MATCH on methods - use CLOSURE_MATCH on functions ([#166155](https://github.com/pytorch/pytorch/pull/166155))
- [dynamo] Remove unnecessary NAME_MATCH guard ([#166112](https://github.com/pytorch/pytorch/pull/166112))
- [hops] fix unbacked runtime asserts for cond higher order op ([#165893](https://github.com/pytorch/pytorch/pull/165893))
- [dynamo] Repro for 166238 ([#166252](https://github.com/pytorch/pytorch/pull/166252))
- [dynamo][guards] CLASS_MATCH guard for readability ([#166217](https://github.com/pytorch/pytorch/pull/166217))
- [dynamo] Move some FUNCTION_MATCH to CLOSURE_MATCH ([#166244](https://github.com/pytorch/pytorch/pull/166244))
- [dynamo] Fix python_type for UserDefinedClassExceptionVariable ([#166251](https://github.com/pytorch/pytorch/pull/166251))
- [dynamo] Fix recompilation error message to point to new programming model docs ([#165260](https://github.com/pytorch/pytorch/pull/165260))
- [dynamo] Dont guard on numpy Cython functions ([#166328](https://github.com/pytorch/pytorch/pull/166328))
- [reland][dynamo][easy] Support torch.accelerator.current_accelerator ([#166327](https://github.com/pytorch/pytorch/pull/166327))
- [dynamo] local_map error message for reordered inputs ([#164780](https://github.com/pytorch/pytorch/pull/164780))
- [dynamo, nested graph breaks] add TestCaseWithNestedGraphBreaks subclass ([#166013](https://github.com/pytorch/pytorch/pull/166013))
- [dynamo, nested graph breaks] remove _dynamo.utils.counter patch on inlined tx'es ([#166015](https://github.com/pytorch/pytorch/pull/166015))
- [dynamo, nested graph breaks] fix RETURN_VALUE tx skipping in nested graph breaks ([#165808](https://github.com/pytorch/pytorch/pull/165808))
- [dynamo, nested graph breaks] disable nested graph breaks in generators; enable nested_graph_breaks in test_ctx_manager.py and test_generator.py ([#165809](https://github.com/pytorch/pytorch/pull/165809))
- [dynamo, nested graph breaks] disallow nested graph breaks in HOPs ([#166016](https://github.com/pytorch/pytorch/pull/166016))
- [dynamo] Guard selectively on the torch APIs ([#166329](https://github.com/pytorch/pytorch/pull/166329))
- [dynamo] Dont guard on getset descriptors for torch_function ([#166346](https://github.com/pytorch/pytorch/pull/166346))
- [dynamo] fix store attr graph break in with block ([#166036](https://github.com/pytorch/pytorch/pull/166036))
- [dynamo] fix keyerror in resume_execution (again) ([#166040](https://github.com/pytorch/pytorch/pull/166040))
- [dynamo] Revert C++-fying of symbolic shape guards ([#166427](https://github.com/pytorch/pytorch/pull/166427))
- [dynamo] Clean up assert in dynamo [3/N] ([#165903](https://github.com/pytorch/pytorch/pull/165903))
- [dynamo][guards] Do not guard on the queue_callback ([#166437](https://github.com/pytorch/pytorch/pull/166437))
- [dynamo] Move more FUNCTION_MATCH to CLOSURE_MATCH ([#166444](https://github.com/pytorch/pytorch/pull/166444))
- [dynamo][easy] Use CONSTANT_MATCH for __code__ guard ([#166445](https://github.com/pytorch/pytorch/pull/166445))
- [precompile] Pickle and check closure variable properly. ([#166351](https://github.com/pytorch/pytorch/pull/166351))
- Fix existing Pyrefly errors ([#166439](https://github.com/pytorch/pytorch/pull/166439))
- [dynamo] Add __iter__ for iterable VariableTrackers ([#166349](https://github.com/pytorch/pytorch/pull/166349))
- [dynamo] Implement iter with a polyfill ([#162768](https://github.com/pytorch/pytorch/pull/162768))
- [dynamo] Fix ListIterator tracking mutations to original list ([#166350](https://github.com/pytorch/pytorch/pull/166350))
- [ROCm][CUDA] add unit test utility busy_wait_for_flag ([#166218](https://github.com/pytorch/pytorch/pull/166218))
- [dynamo] support tracing new typing union syntax X | Y ([#166599](https://github.com/pytorch/pytorch/pull/166599))
- [dynamo, nested graph breaks] codegen dead nested cells correctly ([#166476](https://github.com/pytorch/pytorch/pull/166476))
- [dynamo, nested graph breaks] add disable_nested_graph_breaks decorator/context manager ([#166477](https://github.com/pytorch/pytorch/pull/166477))
- Refactor AOTAutogradCacheEntry into AOTAutogradResult ([#166656](https://github.com/pytorch/pytorch/pull/166656))
- [dynamo] clarify graph break handling/logging in symbolic_convert ([#166587](https://github.com/pytorch/pytorch/pull/166587))
- [dynamo, 3.14] fix segfault due to improper create_call_function_ex ([#166678](https://github.com/pytorch/pytorch/pull/166678))
- [precompile] Preserve default arguments for dynamo capture ([#166654](https://github.com/pytorch/pytorch/pull/166654))
- [user-streams] cleanup StreamVariable signature ([#166471](https://github.com/pytorch/pytorch/pull/166471))
- Fix source_fn_stack being None ([#166728](https://github.com/pytorch/pytorch/pull/166728))
- [export] Return more information from tracing context in graph capture. ([#166775](https://github.com/pytorch/pytorch/pull/166775))
- [export] Make dict_keys_getitem tracable. ([#166776](https://github.com/pytorch/pytorch/pull/166776))
- [export] Downgrade captured buffers as normal constants. ([#166777](https://github.com/pytorch/pytorch/pull/166777))
- [BE][Typing][Dynamo] Type torch/_dynamo/variables/builtin.py ([#166745](https://github.com/pytorch/pytorch/pull/166745))
- [dynamo] Raise on as_python_constant error on getattr ([#166909](https://github.com/pytorch/pytorch/pull/166909))
- [dynamo, 3.14] support tracing type.__dict__[__annotations__].__get__ to trace through typing.get_type_hints ([#166757](https://github.com/pytorch/pytorch/pull/166757))
- [dynamo, 3.14] disable cpython dynamo unittests if 3.14 ([#166895](https://github.com/pytorch/pytorch/pull/166895))
- [dynamo] Implement __sym_float__ for SymBool to fix multiplication TypeError ([#165264](https://github.com/pytorch/pytorch/pull/165264))
- inductor: Switch quiesce to use timer based implementation. ([#166581](https://github.com/pytorch/pytorch/pull/166581))
- [dynamo]  don't use LocalSource for temp variables created by side_effects ([#166917](https://github.com/pytorch/pytorch/pull/166917))
- [BE][Typing][Dynamo] Type torch/_dynamo/variables/ctx_manager.py ([#166878](https://github.com/pytorch/pytorch/pull/166878))
- [dynamo] Introduce _set_lru_cache ([#167038](https://github.com/pytorch/pytorch/pull/167038))
- [BE][Typing][Dynamo] Type torch/_dynamo/variables/dicts.py ([#167022](https://github.com/pytorch/pytorch/pull/167022))
- [ez] avoid log spam when random data is generated ([#166919](https://github.com/pytorch/pytorch/pull/166919))
- [BE][Typing][Dynamo] Type torch/_dynamo/variables/lists.py ([#167156](https://github.com/pytorch/pytorch/pull/167156))
- [dynamo] unimplemented -> unimplemented_v2 for the rest of variables/misc.py ([#167001](https://github.com/pytorch/pytorch/pull/167001))
- [dynamo] unimplemented -> unimplemented_v2 in variables/higher_order_ops.py ([#167146](https://github.com/pytorch/pytorch/pull/167146))
- [dynamo] unimplemented -> unimplemented_v2 in torch/_subclasses/meta_utils.py ([#167159](https://github.com/pytorch/pytorch/pull/167159))
- [dynamo] remove old unimplemented() call ([#167149](https://github.com/pytorch/pytorch/pull/167149))
- [14/N] Apply ruff UP035 rule  ([#167208](https://github.com/pytorch/pytorch/pull/167208))
- [easy][dynamo][pytree] simplify pytree polyfill module by move out the guard-if ([#167221](https://github.com/pytorch/pytorch/pull/167221))
- [PT2 Compiler] Add flag in dynamo disable wrapper to indicate reursive disable ([#165790](https://github.com/pytorch/pytorch/pull/165790))
- Refactor recursive call of collect_temp_source ([#166714](https://github.com/pytorch/pytorch/pull/166714))
- [dynamo][pytree] add polyfills for optree path APIs ([#167211](https://github.com/pytorch/pytorch/pull/167211))
- [dynamo][guards] Fix mem leak in tensor subclass metadata guard ([#167352](https://github.com/pytorch/pytorch/pull/167352))
- [dynamo][hops] Overwrite proxy of the original VT to the subgraph outputs ([#167160](https://github.com/pytorch/pytorch/pull/167160))
- [dynamo] Make sym node vt creation via SymNodeVariable create ([#167189](https://github.com/pytorch/pytorch/pull/167189))
- [dynamo] rename unimplemented_v2 -> unimplemented ([#167150](https://github.com/pytorch/pytorch/pull/167150))
- [dynamo] replace raise Unsupported(...) with unimplemented(...) ([#167255](https://github.com/pytorch/pytorch/pull/167255))
- [dynamo][ac] Return all intermediates as outputs for AC Hop ([#167192](https://github.com/pytorch/pytorch/pull/167192))
- Support repr on user defined objects ([#167372](https://github.com/pytorch/pytorch/pull/167372))
- [ez] Remove spammy deprecation log ([#167470](https://github.com/pytorch/pytorch/pull/167470))
- [BugFix][Refactor] fix several instances which use f = open(...) without a corresponding f.close() ([#167423](https://github.com/pytorch/pytorch/pull/167423))
- Cpython test_math.FMATests ([#167217](https://github.com/pytorch/pytorch/pull/167217))
- [dynamo] speculate_subgraph_with_auto_output_flattening ([#167438](https://github.com/pytorch/pytorch/pull/167438))
- [dynamo] Make HintsWrapperHigherOrderVariable follow wrap semantics ([#167442](https://github.com/pytorch/pytorch/pull/167442))
- [dynamo][invoke_subgraph] Do not restore side effects on invoke_subgraph ([#167446](https://github.com/pytorch/pytorch/pull/167446))
- [opaque obj] torch.compile support ([#163936](https://github.com/pytorch/pytorch/pull/163936))
- [dynamo] [3.14] Support np._CopyMode ([#167619](https://github.com/pytorch/pytorch/pull/167619))
- [dynamo] [3.14] Update broken numpy test ([#167681](https://github.com/pytorch/pytorch/pull/167681))
- [dynamo] clean up BaseUserFunctionVariable and LocalGeneratorObjectVariable ([#166673](https://github.com/pytorch/pytorch/pull/166673))
- [dynamo, nested graph breaks] disallow graph breaks in functorch ops, enable nested graph break tests on test_higher_order_ops.py ([#166674](https://github.com/pytorch/pytorch/pull/166674))
- [Dynamo] Imporve-graph-break-skip-logs ([#167067](https://github.com/pytorch/pytorch/pull/167067))
- [export] Add pytree input check for dynamo_graph_capture_for_export ([#167731](https://github.com/pytorch/pytorch/pull/167731))
- [export] Disable side effects on dynamo_graph_capture_for_export and warn user. ([#167763](https://github.com/pytorch/pytorch/pull/167763))
- [precompile] Support captured global tensors. ([#167846](https://github.com/pytorch/pytorch/pull/167846))
- [export] Support module type with only __call__ override. ([#167874](https://github.com/pytorch/pytorch/pull/167874))
- Fix: Dynamo log always emits ANSI color codes into torch_compile_debug/torchdynamo/debug.log due to colored=True in lazy_format_graph_code ([#167823](https://github.com/pytorch/pytorch/pull/167823))
- [HOP][print][dynamo]Add dynamo for hop print ([#167571](https://github.com/pytorch/pytorch/pull/167571))
- [user-streams] Refactor out event insertion for record_stream handling ([#168228](https://github.com/pytorch/pytorch/pull/168228))
- [precompile] nicer error message when caches are disabled ([#168274](https://github.com/pytorch/pytorch/pull/168274))
- [dynamo, nested graph breaks] fix FOR_ITER iterator push and zip strict; enable nested graph break tests on test_functions.py ([#167694](https://github.com/pytorch/pytorch/pull/167694))
- [dynamo, nested graph breaks] Fix-nested-graph-break-suppression ([#167743](https://github.com/pytorch/pytorch/pull/167743))
- Narrow the return type annotation in 'VariableTracker::call_obj_hasattr' ([#167983](https://github.com/pytorch/pytorch/pull/167983))
- [dynamo][guards] Log backend match recompilation reason ([#168387](https://github.com/pytorch/pytorch/pull/168387))
- [dynamo] Add optree.tree_map microbenchmark ([#168341](https://github.com/pytorch/pytorch/pull/168341))
- [dynamo] Special case handling for tree_map ([#168342](https://github.com/pytorch/pytorch/pull/168342))
- [dynamo] Special case handling for tree_map_only ([#168365](https://github.com/pytorch/pytorch/pull/168365))
- [dynamo] Fix local test failures for dynamo/test_repros.py ([#168893](https://github.com/pytorch/pytorch/pull/168893))
- [dynamo][hops] Add xfail tests for side effects ([#168394](https://github.com/pytorch/pytorch/pull/168394))
- [dynamo] Remove redundant _nonvar_fields assignments in UserDefinedObjectVariable subclasses ([#167801](https://github.com/pytorch/pytorch/pull/167801))
- [dynamo] Skip optree tests when optree isn't installed ([#168931](https://github.com/pytorch/pytorch/pull/168931))
- [dynamo] Fix local test failures for test/dynamo/test_after_aot.py ([#168914](https://github.com/pytorch/pytorch/pull/168914))
- [dynamo] Fix local test failures for test_compiler_bisector.py ([#168915](https://github.com/pytorch/pytorch/pull/168915))
- [dynamo] Fix more cases of tests leaking config changes ([#168924](https://github.com/pytorch/pytorch/pull/168924))
- [dynamo] Isolate test/dynamo/test_aot_compile.py tests in subproc ([#168925](https://github.com/pytorch/pytorch/pull/168925))
- [dynamo] Make test custom op naming unique ([#168926](https://github.com/pytorch/pytorch/pull/168926))
- Add human-readable type name comment to TYPE_MATCH guards for debugging clarity ([#168272](https://github.com/pytorch/pytorch/pull/168272))
- [3.14] Fix nn.Module annotations lookup ([#168325](https://github.com/pytorch/pytorch/pull/168325))
- [precompile] set strict_autograd_cache=True when precompiling ([#168989](https://github.com/pytorch/pytorch/pull/168989))
- Refactor call_function ([#168932](https://github.com/pytorch/pytorch/pull/168932))
- [precompile] move strict_autograd_cache=True decorator to aot_compile_fullgraph ([#169008](https://github.com/pytorch/pytorch/pull/169008))
- [dynamo] Support functools.partial as dict key ([#169016](https://github.com/pytorch/pytorch/pull/169016))
- [pytree][dynamo] make `tree_*` functions accept both Python and C++ `PyTreeSpec` ([#152624](https://github.com/pytorch/pytorch/pull/152624))
- [dynamo, 3.14] Ensure `typing.Union` is correctly traced in Dynamo. ([#169084](https://github.com/pytorch/pytorch/pull/169084))
- [dynamo] Skip Dynamo wrapped tests on cpython tests ([#169233](https://github.com/pytorch/pytorch/pull/169233))
- Remove unused TVM code in dynamo ([#169247](https://github.com/pytorch/pytorch/pull/169247))
- [precompile] support serde for torch.nn.attention.SDPBackend ([#168988](https://github.com/pytorch/pytorch/pull/168988))
- [dynamo] Fix test state leakage for test_modes.py ([#168928](https://github.com/pytorch/pytorch/pull/168928))
- [dynamo] Fix local test failures for logging ([#168927](https://github.com/pytorch/pytorch/pull/168927))
- [precompile] Include inductor-generated Dynamo guards in AOT ([#169239](https://github.com/pytorch/pytorch/pull/169239))
- Add DCE pass to remove unused intermediates ([#169131](https://github.com/pytorch/pytorch/pull/169131))
- [BE][Typing][Dynamo] Type torch/_dynamo/variables/nn_module.py ([#167342](https://github.com/pytorch/pytorch/pull/167342))
- [dynamo] Fix more local test failures ([#169228](https://github.com/pytorch/pytorch/pull/169228))
- REmove AC specific flag and reunify with HOPs ([#169132](https://github.com/pytorch/pytorch/pull/169132))
- [ez] add return type to _unpickle_sdp_backend ([#169383](https://github.com/pytorch/pytorch/pull/169383))
- [dynamo][hops] Remove restore_side_effect from the auto flattening codepath ([#169394](https://github.com/pytorch/pytorch/pull/169394))
- [Dynamo] Adding `strict` as a kwarg for `map()` in Python3.14 ([#167828](https://github.com/pytorch/pytorch/pull/167828))
- Remove `LocalGeneratorObjectVariable::_get_inline_tracer()` ([#169306](https://github.com/pytorch/pytorch/pull/169306))
- Fix deprecation warning ([#169421](https://github.com/pytorch/pytorch/pull/169421))
- [aot_compile] Pass additional globals to callable ([#169070](https://github.com/pytorch/pytorch/pull/169070))
- [dynamo][benchmarks] add option to force amp to use bfloat16 instead of float16 ([#169449](https://github.com/pytorch/pytorch/pull/169449))
- [opaque obj] Set type of FakeScriptObj to be OpaqueObj type ([#167741](https://github.com/pytorch/pytorch/pull/167741))
- [dynamo, guards] cache GuardBuilder.get() on sources ([#168203](https://github.com/pytorch/pytorch/pull/168203))
- [dynamo, guards] cache Source.guard_source ([#168386](https://github.com/pytorch/pytorch/pull/168386))
- [dynamo, guards] cache Source hashing ([#168886](https://github.com/pytorch/pytorch/pull/168886))
- [dynamo] Support Sequence-like placement user defined objects from_local ([#169531](https://github.com/pytorch/pytorch/pull/169531))
- [dynamo] support tracing DeviceMesh._flatten ([#169530](https://github.com/pytorch/pytorch/pull/169530))
- [dde] use is_contiguous_or_false for function with out= arg ([#169305](https://github.com/pytorch/pytorch/pull/169305))
- [dynamo][dicts] Prepare for dict refactor for fewer conflicts ([#169589](https://github.com/pytorch/pytorch/pull/169589))
- [dynamo] Prep for dict key refactor - add hash related methods to VT ([#169610](https://github.com/pytorch/pytorch/pull/169610))
- [dynamo] assign random IDs to graph break registry ([#169617](https://github.com/pytorch/pytorch/pull/169617))
- [dynamo] add new graph break registry entries via linter to random spots ([#169624](https://github.com/pytorch/pytorch/pull/169624))
- [Dynamo] Supports `from_number` method for `float` and `complex` in Python3.14 ([#169558](https://github.com/pytorch/pytorch/pull/169558))
- [dynamo][hops] Add automatic_with_forced_inputs in a small PR ([#169717](https://github.com/pytorch/pytorch/pull/169717))
- [dynamo] do not graph break under generic ctx manager if fullgraph=True ([#169708](https://github.com/pytorch/pytorch/pull/169708))
- [Dynamo][TEST] Skip test_guard_serialization_fsdp_module if distributed is not available ([#169660](https://github.com/pytorch/pytorch/pull/169660))
- [dynamo] Optimize VariableTrackerMeta isinstance checks ([#169341](https://github.com/pytorch/pytorch/pull/169341))
- [dynamo] Refactor isinstance(x, TensorVariable) to x.is_tensor() ([#169441](https://github.com/pytorch/pytorch/pull/169441))
- [dynamo] Fix set_recursion_limit test state leakage ([#169553](https://github.com/pytorch/pytorch/pull/169553))
- [dynamo] Delete 3 classes that were basically fancy string holders ([#167798](https://github.com/pytorch/pytorch/pull/167798))
- [dynamo, nested graph breaks] remove STORE_ATTR graph break path; fix nested STORE_ATTR graph breaks ([#169536](https://github.com/pytorch/pytorch/pull/169536))
- [dynamo] Skip the duplicate input guard if any of the source is SkipGuardSource ([#169933](https://github.com/pytorch/pytorch/pull/169933))
- Add alias filtering to invoke subgraph ([#169134](https://github.com/pytorch/pytorch/pull/169134))
- [DynamoCache] fix when the fn to compile is a torch.nn.Module ([#169826](https://github.com/pytorch/pytorch/pull/169826))
- [opaque obj] Add value-type opaque obj ([#167768](https://github.com/pytorch/pytorch/pull/167768))
- [Bugfix] Check known tensor attributes in TensorVariable.call_obj_hasattr ([#167651](https://github.com/pytorch/pytorch/pull/167651))
- [dynamo] Fix TORCH_COMPILE_CPROFILE for python >= 3.12 ([#170013](https://github.com/pytorch/pytorch/pull/170013))
- Make functionalization `ViewMeta` serializable with pickle ([#163769](https://github.com/pytorch/pytorch/pull/163769))
- Set fake_mode of base tensor in fx graph pickler ([#163738](https://github.com/pytorch/pytorch/pull/163738))
- Support for pickling einops for aot_autograd serialization in vLLM ([#165359](https://github.com/pytorch/pytorch/pull/165359))
- Implement an AOT precompile mode for standalone_compile ([#165843](https://github.com/pytorch/pytorch/pull/165843))
- [dynamo, 3.14] fix misc. bugs to get most dynamo unittests passing locally in 3.14 ([#164631](https://github.com/pytorch/pytorch/pull/164631))
### security
